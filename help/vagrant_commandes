#Vagrant commandes : 

vagrant init : initialise un projet Vagrant 

vagrant status : voir l'état de la machine 

vagrant up : démarre une machine 

vagrant suspend : met la VM en pause (état sauvegardé en RAM).

vagrant halt : arrête la machine, (éteint proprement la machine comme un shutdown classique)

vagrant reload : redémarre la machine

vagrant destroy -f  : detruit les VM

vagrant provision : la provision c’est la partie où Vagrant lance des scripts ou des outils pour configurer automatiquement ta VM une fois qu’elle est démarrée (par exemple installer K3s une fois la VM démarrer)

vagrant reload --provision : redémarre la VM et relance la provision

Résumé :

| Action                           | Commande          | Fréquence                      |
| -------------------------------- | ----------------- | ------------------------------ |
| Initialiser un projet Vagrant    | `vagrant init`    | Une seule fois au début        |
|                                  |                   |                                |
| Démarrer la machine après reboot | `vagrant up`      | À chaque redémarrage ou besoin |
|                                  |                   |                                |
| Se connecter                     | `vagrant ssh`     | Quand tu veux utiliser la VM   |
|                                  |                   |                                |
| Détruire la VM                   | `vagrant destroy` | Si tu veux repartir de zéro    |
|                                  |                   |                                |
| Recréer une VM après destruction | `vagrant up`      | Sans refaire `vagrant init`    |
-----------------------------------------------------------------------------------------

# Lister les VMs VirtualBox
VBoxManage list vms

# Supprimer chaque VM (remplace "lciulloS" par le nom exact)
VBoxManage unregistervm "lciulloS" --delete
VBoxManage unregistervm "lciulloSW" --delete

# Nettoyer Vagrant
rm -rf .vagrant/

# Recréer
vagrant up
#Fix ce warning : dpkg-preconfigure: unable to re-open stdin: No such file or directory
export DEBIAN_FRONTEND=noninteractive

# Trouver où sont stockées les VMs VirtualBox
ls -la ~/VirtualBox\ VMs/

# Changer le propriétaire récursivement
sudo chown -R $(whoami):$(whoami) ~/VirtualBox\ VMs/


#A verifier 
lciulloSW: [INFO]  Host iptables-save/iptables-restore tools not found
lciulloSW: [INFO]  Host ip6tables-save/ip6tables-restore tools not found

sudo journalctl -u k3s-agent -f
# Vérifie si le master est bien accessible
vagrant ssh lciulloSW -c "curl -k https://192.168.56.110:6443"

vagrant ssh lciulloS -c "sudo systemctl status k3s --no-pager"

Le problème principal est que plusieurs pods système (dont coredns, traefik, metrics-server) ne démarrent pas correctement sur le master.  
Tant que ces pods sont en erreur ou en CrashLoopBackOff, le cluster ne sera pas fonctionnel et les workers ne pourront pas s'enregistrer.

**Ce qu'il faut faire maintenant :**
1. Inspecter les logs d'au moins un pod en erreur, par exemple coredns :
   ```bash
   vagrant ssh lciulloS -c "sudo kubectl logs -n kube-system coredns-64fd4b4794-q5h4f"
   ```
2. Corriger l'erreur affichée (souvent liée à un problème réseau, DNS, ou ressources manquantes).

Voulez-vous que je récupère les logs de coredns pour vous ?

sudo systemctl status k3s-agent
sudo systemctl status k3s-agent.service
